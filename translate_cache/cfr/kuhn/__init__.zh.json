{
 "<h1><a href=\"../index.html\">Counterfactual Regret Minimization (CFR)</a> on Kuhn Poker</h1>\n<p>This applies <a href=\"../index.html\">Counterfactual Regret Minimization (CFR)</a> to Kuhn poker.</p>\n<p><a href=\"https://en.wikipedia.org/wiki/Kuhn_poker\">Kuhn Poker</a> is a two player 3-card betting game. The players are dealt one card each out of Ace, King and Queen (no suits). There are only three cards in the pack so one card is left out. Ace beats King and Queen and King beats Queen - just like in normal ranking of cards.</p>\n<p>Both players ante <span translate=no>_^_0_^_</span> chip (blindly bet <span translate=no>_^_1_^_</span> chip). After looking at the cards, the first player can either pass or bet <span translate=no>_^_2_^_</span> chip. If first player passes, the the player with higher card wins the pot. If first player bets, the second play can bet (i.e. call) <span translate=no>_^_3_^_</span> chip or pass (i.e. fold). If the second player bets and the player with the higher card wins the pot. If the second player passes (i.e. folds) the first player gets the pot. This game is played repeatedly and a good strategy will optimize for the long term utility (or winnings).</p>\n<p>Here&#x27;s some example games:</p>\n<ul><li><span translate=no>_^_4_^_</span> - Player 1 gets K. Player 2 gets A. Player 1 passes. Player 2 doesn&#x27;t get a betting chance and Player 2 wins the pot of <span translate=no>_^_5_^_</span> chips. </li>\n<li><span translate=no>_^_6_^_</span> - Player 1 gets Q. Player 2 gets K. Player 1 bets a chip. Player 2 passes (folds). Player 1 gets the pot of <span translate=no>_^_7_^_</span> because Player 2 folded. </li>\n<li><span translate=no>_^_8_^_</span> - Player 1 gets Q. Player 2 gets A. Player 1 bets a chip. Player 2 also bets (calls). Player 2 wins the pot of <span translate=no>_^_9_^_</span>.</li></ul>\n<p>He we extend the <span translate=no>_^_10_^_</span> class and <span translate=no>_^_11_^_</span> class defined in <a href=\"../index.html\"><span translate=no>_^_12_^_</span></a> with Kuhn Poker specifics.</p>\n<p><a href=\"https://colab.research.google.com/github/labmlai/annotated_deep_learning_paper_implementations/blob/master/labml_nn/cfr/kuhn/experiment.ipynb\"><span translate=no>_^_13_^_</span></a></p>\n": "<h1>Kuhn Poker \u4e0a\u7684<a href=\"../index.html\">\u53cd\u4e8b\u5b9e\u540e\u6094\u6700\u5c0f\u5316 (CFR)</a></h1>\n<p>\u8fd9\u5c06\u300a<a href=\"../index.html\">\u53cd\u4e8b\u5b9e\u540e\u6094\u6700\u5c0f\u5316\u300b\uff08CFR\uff09</a>\u5e94\u7528\u4e8e\u5e93\u6069\u6251\u514b\u3002</p>\n<p><a href=\"https://en.wikipedia.org/wiki/Kuhn_poker\">Kuhn Poker</a> \u662f\u4e00\u6b3e\u53cc\u4eba\u4e09\u5f20\u724c\u7684\u4e0b\u6ce8\u6e38\u620f\u3002\u73a9\u5bb6\u4ece A\u3001K \u548c Queen \u4e2d\u5404\u83b7\u5f97\u4e00\u5f20\u724c\uff08\u65e0\u82b1\u8272\uff09\u3002\u5305\u4e2d\u53ea\u6709\u4e09\u5f20\u724c\uff0c\u6240\u4ee5\u9057\u6f0f\u4e86\u4e00\u5f20\u724c\u3002Ace \u51fb\u8d25 King \u548c Queen\uff0cKing \u51fb\u8d25 Queen \u2014\u2014\u5c31\u50cf\u666e\u901a\u5361\u724c\u6392\u540d\u4e00\u6837\u3002</p>\n<p>\u4e24\u4e2a\u73a9\u5bb6\u90fd\u62bc\u6ce8<span translate=no>_^_0_^_</span>\u7b79\u7801\uff08\u76f2\u6ce8<span translate=no>_^_1_^_</span>\u7b79\u7801\uff09\u3002\u770b\u5b8c\u724c\u540e\uff0c\u7b2c\u4e00\u4e2a\u73a9\u5bb6\u53ef\u4ee5\u4f20\u7403\u6216\u4e0b\u6ce8<span translate=no>_^_2_^_</span>\u7b79\u7801\u3002\u5982\u679c\u7b2c\u4e00\u4e2a\u73a9\u5bb6\u901a\u8fc7\uff0c\u5219\u62e5\u6709\u8f83\u9ad8\u724c\u7684\u73a9\u5bb6\u8d62\u5f97\u5e95\u6c60\u3002\u5982\u679c\u7b2c\u4e00\u4e2a\u73a9\u5bb6\u4e0b\u6ce8\uff0c\u7b2c\u4e8c\u4e2a\u73a9\u5bb6\u53ef\u4ee5\u4e0b\u6ce8\uff08\u5373\u8ddf\u6ce8\uff09<span translate=no>_^_3_^_</span>\u7b79\u7801\u6216\u8fc7\u5173\uff08\u5373\u76d6\u724c\uff09\u3002\u5982\u679c\u7b2c\u4e8c\u4e2a\u73a9\u5bb6\u4e0b\u6ce8\uff0c\u800c\u62e5\u6709\u8f83\u9ad8\u724c\u7684\u73a9\u5bb6\u8d62\u5f97\u5e95\u6c60\u3002\u5982\u679c\u7b2c\u4e8c\u4e2a\u73a9\u5bb6\u901a\u8fc7\uff08\u5373\u5f03\u724c\uff09\uff0c\u5219\u7b2c\u4e00\u4e2a\u73a9\u5bb6\u83b7\u5f97\u5e95\u6c60\u3002\u8fd9\u4e2a\u6e38\u620f\u662f\u53cd\u590d\u73a9\u7684\uff0c\u4e00\u4e2a\u597d\u7684\u7b56\u7565\u5c06\u9488\u5bf9\u957f\u671f\u6548\u7528\uff08\u6216\u83b7\u5229\uff09\u8fdb\u884c\u4f18\u5316\u3002</p>\n<p>\u4ee5\u4e0b\u662f\u4e00\u4e9b\u793a\u4f8b\u6e38\u620f\uff1a</p>\n<ul><li><span translate=no>_^_4_^_</span>-\u73a9\u5bb6 1 \u83b7\u5f97 K \u73a9\u5bb6 2 \u83b7\u5f97 A. \u73a9\u5bb6 1 \u4f20\u7403\u3002\u73a9\u5bb6 2 \u6ca1\u6709\u4e0b\u6ce8\u673a\u4f1a\uff0c\u73a9\u5bb6 2 \u8d62\u5f97<span translate=no>_^_5_^_</span>\u7b79\u7801\u5e95\u6c60\u3002</li>\n<li><span translate=no>_^_6_^_</span>-\u73a9\u5bb6 1 \u5f97\u5230 Q\u3002\u73a9\u5bb6 2 \u5f97\u5230 K\u3002\u73a9\u5bb6 1 \u4e0b\u6ce8\u4e00\u4e2a\u7b79\u7801\u3002\u73a9\u5bb62\u4f20\u7403\uff08\u5f03\u724c\uff09\u3002\u73a9\u5bb6 1 \u62ff\u5230\u5e95\u6c60<span translate=no>_^_7_^_</span>\u662f\u56e0\u4e3a\u73a9\u5bb6 2 \u76d6\u724c\u3002</li>\n<li><span translate=no>_^_8_^_</span>-\u73a9\u5bb6 1 \u5f97\u5230 Q\u3002\u73a9\u5bb6 2 \u5f97\u5230 A. \u73a9\u5bb6 1 \u4e0b\u6ce8\u4e00\u4e2a\u7b79\u7801\u3002\u73a9\u5bb62\u4e5f\u4e0b\u6ce8\uff08\u8ddf\u6ce8\uff09\u3002\u73a9\u5bb6 2 \u8d62\u5f97\u5e95\u6c60<span translate=no>_^_9_^_</span>\u3002</li></ul>\n<p>\u4ed6<a href=\"../index.html\"><span translate=no>_^_12_^_</span></a>\u7528Kuhn Poker\u7684\u5177\u4f53\u5185\u5bb9\u6269\u5c55\u4e86\u4e2d\u5b9a\u4e49\u7684<span translate=no>_^_10_^_</span><span translate=no>_^_11_^_</span>\u7c7b\u522b\u548c\u7b49\u7ea7\u3002</p>\n<p><a href=\"https://colab.research.google.com/github/labmlai/annotated_deep_learning_paper_implementations/blob/master/labml_nn/cfr/kuhn/experiment.ipynb\"><span translate=no>_^_13_^_</span></a></p>\n",
 "<h2><a href=\"../index.html#History\">History</a></h2>\n<p>This defines when a game ends, calculates the utility and sample chance events (dealing cards).</p>\n<p>The history is stored in a string:</p>\n<ul><li>First two characters are the cards dealt to player 1 and player 2 </li>\n<li>The third character is the action by the first player </li>\n<li>Fourth character is the action by the second player</li></ul>\n": "<h2><a href=\"../index.html#History\">\u5386\u53f2</a></h2>\n<p>\u8fd9\u5b9a\u4e49\u4e86\u6e38\u620f\u4f55\u65f6\u7ed3\u675f\uff0c\u8ba1\u7b97\u6548\u7528\u548c\u62bd\u6837\u673a\u4f1a\u4e8b\u4ef6\uff08\u53d1\u724c\uff09\u3002</p>\n<p>\u5386\u53f2\u8bb0\u5f55\u5b58\u50a8\u5728\u5b57\u7b26\u4e32\u4e2d\uff1a</p>\n<ul><li>\u524d\u4e24\u4e2a\u89d2\u8272\u662f\u53d1\u7ed9\u73a9\u5bb6 1 \u548c\u73a9\u5bb6 2 \u7684\u724c</li>\n<li>\u7b2c\u4e09\u4e2a\u89d2\u8272\u662f\u7b2c\u4e00\u4e2a\u73a9\u5bb6\u7684\u52a8\u4f5c</li>\n<li>\u7b2c\u56db\u4e2a\u89d2\u8272\u662f\u7b2c\u4e8c\u4e2a\u73a9\u5bb6\u7684\u52a8\u4f5c</li></ul>\n",
 "<h2><a href=\"../index.html#InfoSet\">Information set</a></h2>\n": "<h2><a href=\"../index.html#InfoSet\">\u4fe1\u606f\u96c6</a></h2>\n",
 "<h3>Run the experiment</h3>\n": "<h3>\u8fd0\u884c\u5b9e\u9a8c</h3>\n",
 "<p> </p>\n": "<p></p>\n",
 "<p> Add an action to the history and return a new history</p>\n": "<p>\u5728\u5386\u53f2\u8bb0\u5f55\u4e2d\u6dfb\u52a0\u64cd\u4f5c\u5e76\u8fd4\u56de\u65b0\u7684\u5386\u53f2\u8bb0\u5f55</p>\n",
 "<p> Calculate the terminal utility for player <span translate=no>_^_0_^_</span>, <span translate=no>_^_1_^_</span></p>\n": "<p>\u8ba1\u7b97\u73a9\u5bb6\u7684\u7ec8\u7aef\u5b9e\u7528\u7a0b\u5e8f<span translate=no>_^_0_^_</span>\uff0c<span translate=no>_^_1_^_</span></p>\n",
 "<p> Configurations extends the CFR configurations class</p>\n": "<p>\u914d\u7f6e\u6269\u5c55\u4e86 CFR \u914d\u7f6e\u7c7b</p>\n",
 "<p> Current player</p>\n": "<p>\u5f53\u524d\u73a9\u5bb6</p>\n",
 "<p> Get the terminal utility for player <span translate=no>_^_0_^_</span></p>\n": "<p>\u83b7\u53d6\u73a9\u5bb6\u7684\u7ec8\u7aef\u5b9e\u7528\u7a0b\u5e8f<span translate=no>_^_0_^_</span></p>\n",
 "<p> Human readable representation</p>\n": "<p>\u4eba\u7c7b\u53ef\u8bfb\u7684\u8868\u793a</p>\n",
 "<p> Human readable string representation - it gives the betting probability</p>\n": "<p>\u4eba\u7c7b\u53ef\u8bfb\u7684\u5b57\u7b26\u4e32\u8868\u793a\u2014\u2014\u5b83\u7ed9\u51fa\u4e86\u4e0b\u6ce8\u6982\u7387</p>\n",
 "<p> Information set key for the current history. This is a string of actions only visible to the current player.</p>\n": "<p>\u5f53\u524d\u5386\u53f2\u8bb0\u5f55\u7684\u4fe1\u606f\u96c6\u5173\u952e\u5b57\u3002\u8fd9\u662f\u4e00\u4e32\u4ec5\u5bf9\u5f53\u524d\u73a9\u5bb6\u53ef\u89c1\u7684\u52a8\u4f5c\u3002</p>\n",
 "<p> Initialize with a given history string</p>\n": "<p>\u4f7f\u7528\u7ed9\u5b9a\u7684\u5386\u53f2\u5b57\u7b26\u4e32\u8fdb\u884c\u521d\u59cb\u5316</p>\n",
 "<p> Return the list of actions. Terminal states are handled by <span translate=no>_^_0_^_</span> class.</p>\n": "<p>\u8fd4\u56de\u64cd\u4f5c\u5217\u8868\u3002\u7ec8\u7aef\u72b6\u6001\u7531<span translate=no>_^_0_^_</span>\u7c7b\u5904\u7406\u3002</p>\n",
 "<p> Sample a chance action</p>\n": "<p>\u91c7\u6837\u4e00\u4e2a\u673a\u4f1a\u52a8\u4f5c</p>\n",
 "<p> Set the <span translate=no>_^_0_^_</span> method for Kuhn Poker</p>\n": "<p>\u8bbe\u7f6e\u5e93\u6069\u6251\u514b<span translate=no>_^_0_^_</span>\u7684\u65b9\u6cd5</p>\n",
 "<p> The first two events are card dealing; i.e. chance events</p>\n": "<p>\u524d\u4e24\u4e2a\u4e8b\u4ef6\u662f\u5361\u724c\u4ea4\u6613\uff1b\u5373\u673a\u4f1a\u4e8b\u4ef6</p>\n",
 "<p> Whether the history is terminal (game over).</p>\n": "<p>\u5386\u53f2\u8bb0\u5f55\u662f\u5426\u7ec8\u6b62\uff08\u6e38\u620f\u7ed3\u675f\uff09\u3002</p>\n",
 "<p><span translate=no>_^_0_^_</span> if Player 1 has a better card and <span translate=no>_^_1_^_</span> otherwise </p>\n": "<p><span translate=no>_^_0_^_</span>\u5982\u679c\u73a9\u5bb6 1 \u6709\u66f4\u597d\u7684\u724c<span translate=no>_^_1_^_</span>\u6216\u8005\u5176\u4ed6</p>\n",
 "<p>A function to create an empty history object </p>\n": "<p>\u7528\u4e8e\u521b\u5efa\u7a7a\u5386\u53f2\u5bf9\u8c61\u7684\u51fd\u6570</p>\n",
 "<p>Any other combination </p>\n": "<p>\u4efb\u4f55\u5176\u4ed6\u7ec4\u5408</p>\n",
 "<p>Both players called (bet) (game over) </p>\n": "<p>\u4e24\u4f4d\u73a9\u5bb6\u90fd\u53eb\uff08\u4e0b\u6ce8\uff09\uff08\u6e38\u620f\u7ed3\u675f\uff09</p>\n",
 "<p>Both players called, the player with better card wins <span translate=no>_^_0_^_</span> chips </p>\n": "<p>\u4e24\u4f4d\u73a9\u5bb6\u90fd\u88ab\u53ec\u5524\uff0c\u6301\u6709\u66f4\u597d\u724c\u7684\u73a9\u5bb6\u5c06\u8d62\u5f97<span translate=no>_^_0_^_</span>\u7b79\u7801</p>\n",
 "<p>Create a new information set object </p>\n": "<p>\u521b\u5efa\u65b0\u7684\u4fe1\u606f\u96c6\u5bf9\u8c61</p>\n",
 "<p>Create an experiment, we only write tracking information to <span translate=no>_^_0_^_</span> to speed things up. Since the algorithm iterates fast and we track data on each iteration, writing to other destinations such as Tensorboard can be relatively time consuming. SQLite is enough for our analytics. </p>\n": "<p>\u521b\u5efa\u4e00\u4e2a\u5b9e\u9a8c\uff0c\u6211\u4eec\u53ea\u5199\u8ddf\u8e2a\u4fe1\u606f<span translate=no>_^_0_^_</span>\u6765\u52a0\u5feb\u901f\u5ea6\u3002\u7531\u4e8e\u7b97\u6cd5\u7684\u8fed\u4ee3\u901f\u5ea6\u5f88\u5feb\uff0c\u800c\u4e14\u6211\u4eec\u5728\u6bcf\u6b21\u8fed\u4ee3\u65f6\u90fd\u4f1a\u8ddf\u8e2a\u6570\u636e\uff0c\u56e0\u6b64\u5199\u5165\u5176\u4ed6\u76ee\u6807\uff08\u5982 Tensorboard\uff09\u53ef\u80fd\u76f8\u5bf9\u8017\u65f6\u3002SQLite \u5bf9\u4e8e\u6211\u4eec\u7684\u5206\u6790\u6765\u8bf4\u5df2\u7ecf\u8db3\u591f\u4e86\u3002</p>\n",
 "<p>Current player sees her card and the betting actions </p>\n": "<p>\u5f53\u524d\u73a9\u5bb6\u770b\u5230\u5979\u7684\u724c\u548c\u6295\u6ce8\u52a8\u4f5c</p>\n",
 "<p>Does not support save/load </p>\n": "<p>\u4e0d\u652f\u6301\u4fdd\u5b58/\u52a0\u8f7d</p>\n",
 "<p>First player passed, the player with better card wins <span translate=no>_^_0_^_</span> chip </p>\n": "<p>\u7b2c\u4e00\u4e2a\u73a9\u5bb6\u901a\u8fc7\uff0c\u6301\u6709\u66f4\u597d\u724c\u7684\u73a9\u5bb6\u5c06\u8d62\u5f97<span translate=no>_^_0_^_</span>\u7b79\u7801</p>\n",
 "<p>Get current player </p>\n": "<p>\u83b7\u53d6\u5f53\u524d\u73a9\u5bb6</p>\n",
 "<p>History </p>\n": "<p>\u5386\u53f2</p>\n",
 "<p>History is non-terminal </p>\n": "<p>\u5386\u53f2\u4e0d\u662f\u7ec8\u7ed3\u7684</p>\n",
 "<p>If <span translate=no>_^_0_^_</span> is Player 1 </p>\n": "<p>\u5982\u679c<span translate=no>_^_0_^_</span>\u662f\u73a9\u5bb6 1</p>\n",
 "<p>Initialize configuration </p>\n": "<p>\u521d\u59cb\u5316\u914d\u7f6e</p>\n",
 "<p>Kuhn poker actions are pass (<span translate=no>_^_0_^_</span>) or bet (<span translate=no>_^_1_^_</span>) </p>\n": "<p>\u5e93\u6069\u6251\u514b\u7684\u52a8\u4f5c\u662f pass (<span translate=no>_^_0_^_</span>) \u6216 bet (<span translate=no>_^_1_^_</span>)</p>\n",
 "<p>Last player to play passed (game over) </p>\n": "<p>\u6700\u540e\u4e00\u4e2a\u73a9\u8fc7\u7684\u73a9\u5bb6\u901a\u8fc7\uff08\u6e38\u620f\u7ed3\u675f\uff09</p>\n",
 "<p>Load configuration </p>\n": "<p>\u88c5\u8f7d\u914d\u7f6e</p>\n",
 "<p>Otherwise, <span translate=no>_^_0_^_</span> </p>\n": "<p>\u5426\u5219\uff0c<span translate=no>_^_0_^_</span></p>\n",
 "<p>Players are yet to take actions </p>\n": "<p>\u73a9\u5bb6\u5c1a\u672a\u91c7\u53d6\u884c\u52a8</p>\n",
 "<p>Randomly pick a card </p>\n": "<p>\u968f\u673a\u6311\u9009\u4e00\u5f20\u724c</p>\n",
 "<p>Return the card if it was not dealt before </p>\n": "<p>\u5982\u679c\u4e4b\u524d\u6ca1\u6709\u53d1\u8fc7\u724c\uff0c\u5219\u5f52\u8fd8\u8be5\u724c</p>\n",
 "<p>Second player passed </p>\n": "<p>\u7b2c\u4e8c\u4e2a\u73a9\u5bb6\u901a\u8fc7\u4e86</p>\n",
 "<p>See if the card was dealt before </p>\n": "<p>\u770b\u770b\u4e4b\u524d\u6709\u6ca1\u6709\u53d1\u8fc7\u724c</p>\n",
 "<p>Start iterating </p>\n": "<p>\u5f00\u59cb\u8fed\u4ee3</p>\n",
 "<p>Start the experiment </p>\n": "<p>\u5f00\u59cb\u5b9e\u9a8c</p>\n",
 "<p>The three cards in play are Ace, King and Queen </p>\n": "<p>\u6e38\u620f\u4e2d\u7684\u4e09\u5f20\u724c\u5206\u522b\u662f Ace\u3001King \u548c Queen</p>\n",
 "<p>There are two players </p>\n": "<p>\u6709\u4e24\u4e2a\u73a9\u5bb6</p>\n",
 "CFR on Kuhn Poker": "\u5e93\u6069\u6251\u514b\u4e0a\u7684 CFR",
 "This is an annotated implementation/tutorial of CFR on Kuhn Poker": "\u8fd9\u662f Kuhn Poker \u4e0a\u7684 CFR \u5e26\u6ce8\u91ca\u7684\u5b9e\u73b0/\u6559\u7a0b"
}