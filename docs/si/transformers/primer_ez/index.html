<!DOCTYPE html>
<html lang="si">
<head>
    <meta http-equiv="content-type" content="text/html;charset=utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="description" content="‡∂∏‡∑ô‡∂∫ ‡∂¥‡∑ä‡∂ª‡∂∫‡∑í‡∂∏‡∂ª‡∑ä ‡∑Ñ‡∑í ‡∑Ä‡∑í‡∂†‡∑í‡∂≠ ‡∂ö‡∑ä‡∂ª‡∑í‡∂∫‡∑è‡∂≠‡∑ä‡∂∏‡∂ö ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏/‡∂±‡∑í‡∂∂‡∂±‡∑ä‡∂∞‡∂±‡∂∫‡∂ö‡∑í: PyTorch ‡∑Ñ‡∑í ‡∂Ø‡∑ê‡∂ö‡∑ä‡∂∏ ‡∑É‡∂≥‡∑Ñ‡∑è ‡∂∑‡∑è‡∑Ç‡∑è ‡∂Ü‡∂ö‡∑ò‡∂≠‡∑í ‡∂±‡∑í‡∂ª‡∑ä‡∂∏‡∑è‡∂´‡∂∫ ‡∑É‡∂≥‡∑Ñ‡∑è ‡∂ö‡∑è‡∂ª‡∑ä‡∂∫‡∂ö‡∑ä‡∑Ç‡∂∏ ‡∂ß‡∑ä‡∂ª‡∑è‡∂±‡∑ä‡∑É‡∑ä‡∑Ü‡∑ù‡∂∏‡∂ª‡∑ä ‡∑É‡∑ô‡∑Ä‡∑ì‡∂∏."/>

    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:image:src" content="https://avatars1.githubusercontent.com/u/64068543?s=400&amp;v=4"/>
    <meta name="twitter:title" content="‡∂¥‡∑ä‡∂ª‡∑è‡∂Æ‡∂∏‡∑í‡∂ö‡∂∫: ‡∂∑‡∑è‡∑Ç‡∑è ‡∂Ü‡∂ö‡∑ò‡∂≠‡∑í ‡∂±‡∑í‡∂ª‡∑ä‡∂∏‡∑è‡∂´‡∂∫ ‡∑É‡∂≥‡∑Ñ‡∑è ‡∂ö‡∑è‡∂ª‡∑ä‡∂∫‡∂ö‡∑ä‡∑Ç‡∂∏ ‡∂ß‡∑ä‡∂ª‡∑è‡∂±‡∑ä‡∑É‡∑ä‡∑Ü‡∑ù‡∂∏‡∂ª‡∑ä ‡∑É‡∑ô‡∑Ä‡∑ì‡∂∏"/>
    <meta name="twitter:description" content="‡∂∏‡∑ô‡∂∫ ‡∂¥‡∑ä‡∂ª‡∂∫‡∑í‡∂∏‡∂ª‡∑ä ‡∑Ñ‡∑í ‡∑Ä‡∑í‡∂†‡∑í‡∂≠ ‡∂ö‡∑ä‡∂ª‡∑í‡∂∫‡∑è‡∂≠‡∑ä‡∂∏‡∂ö ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏/‡∂±‡∑í‡∂∂‡∂±‡∑ä‡∂∞‡∂±‡∂∫‡∂ö‡∑í: PyTorch ‡∑Ñ‡∑í ‡∂Ø‡∑ê‡∂ö‡∑ä‡∂∏ ‡∑É‡∂≥‡∑Ñ‡∑è ‡∂∑‡∑è‡∑Ç‡∑è ‡∂Ü‡∂ö‡∑ò‡∂≠‡∑í ‡∂±‡∑í‡∂ª‡∑ä‡∂∏‡∑è‡∂´‡∂∫ ‡∑É‡∂≥‡∑Ñ‡∑è ‡∂ö‡∑è‡∂ª‡∑ä‡∂∫‡∂ö‡∑ä‡∑Ç‡∂∏ ‡∂ß‡∑ä‡∂ª‡∑è‡∂±‡∑ä‡∑É‡∑ä‡∑Ü‡∑ù‡∂∏‡∂ª‡∑ä ‡∑É‡∑ô‡∑Ä‡∑ì‡∂∏."/>
    <meta name="twitter:site" content="@labmlai"/>
    <meta name="twitter:creator" content="@labmlai"/>

    <meta property="og:url" content="https://nn.labml.ai/transformers/primer_ez/index.html"/>
    <meta property="og:title" content="‡∂¥‡∑ä‡∂ª‡∑è‡∂Æ‡∂∏‡∑í‡∂ö‡∂∫: ‡∂∑‡∑è‡∑Ç‡∑è ‡∂Ü‡∂ö‡∑ò‡∂≠‡∑í ‡∂±‡∑í‡∂ª‡∑ä‡∂∏‡∑è‡∂´‡∂∫ ‡∑É‡∂≥‡∑Ñ‡∑è ‡∂ö‡∑è‡∂ª‡∑ä‡∂∫‡∂ö‡∑ä‡∑Ç‡∂∏ ‡∂ß‡∑ä‡∂ª‡∑è‡∂±‡∑ä‡∑É‡∑ä‡∑Ü‡∑ù‡∂∏‡∂ª‡∑ä ‡∑É‡∑ô‡∑Ä‡∑ì‡∂∏"/>
    <meta property="og:image" content="https://avatars1.githubusercontent.com/u/64068543?s=400&amp;v=4"/>
    <meta property="og:site_name" content="‡∂¥‡∑ä‡∂ª‡∑è‡∂Æ‡∂∏‡∑í‡∂ö‡∂∫: ‡∂∑‡∑è‡∑Ç‡∑è ‡∂Ü‡∂ö‡∑ò‡∂≠‡∑í ‡∂±‡∑í‡∂ª‡∑ä‡∂∏‡∑è‡∂´‡∂∫ ‡∑É‡∂≥‡∑Ñ‡∑è ‡∂ö‡∑è‡∂ª‡∑ä‡∂∫‡∂ö‡∑ä‡∑Ç‡∂∏ ‡∂ß‡∑ä‡∂ª‡∑è‡∂±‡∑ä‡∑É‡∑ä‡∑Ü‡∑ù‡∂∏‡∂ª‡∑ä ‡∑É‡∑ô‡∑Ä‡∑ì‡∂∏"/>
    <meta property="og:type" content="object"/>
    <meta property="og:title" content="‡∂¥‡∑ä‡∂ª‡∑è‡∂Æ‡∂∏‡∑í‡∂ö‡∂∫: ‡∂∑‡∑è‡∑Ç‡∑è ‡∂Ü‡∂ö‡∑ò‡∂≠‡∑í ‡∂±‡∑í‡∂ª‡∑ä‡∂∏‡∑è‡∂´‡∂∫ ‡∑É‡∂≥‡∑Ñ‡∑è ‡∂ö‡∑è‡∂ª‡∑ä‡∂∫‡∂ö‡∑ä‡∑Ç‡∂∏ ‡∂ß‡∑ä‡∂ª‡∑è‡∂±‡∑ä‡∑É‡∑ä‡∑Ü‡∑ù‡∂∏‡∂ª‡∑ä ‡∑É‡∑ô‡∑Ä‡∑ì‡∂∏"/>
    <meta property="og:description" content="‡∂∏‡∑ô‡∂∫ ‡∂¥‡∑ä‡∂ª‡∂∫‡∑í‡∂∏‡∂ª‡∑ä ‡∑Ñ‡∑í ‡∑Ä‡∑í‡∂†‡∑í‡∂≠ ‡∂ö‡∑ä‡∂ª‡∑í‡∂∫‡∑è‡∂≠‡∑ä‡∂∏‡∂ö ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏/‡∂±‡∑í‡∂∂‡∂±‡∑ä‡∂∞‡∂±‡∂∫‡∂ö‡∑í: PyTorch ‡∑Ñ‡∑í ‡∂Ø‡∑ê‡∂ö‡∑ä‡∂∏ ‡∑É‡∂≥‡∑Ñ‡∑è ‡∂∑‡∑è‡∑Ç‡∑è ‡∂Ü‡∂ö‡∑ò‡∂≠‡∑í ‡∂±‡∑í‡∂ª‡∑ä‡∂∏‡∑è‡∂´‡∂∫ ‡∑É‡∂≥‡∑Ñ‡∑è ‡∂ö‡∑è‡∂ª‡∑ä‡∂∫‡∂ö‡∑ä‡∑Ç‡∂∏ ‡∂ß‡∑ä‡∂ª‡∑è‡∂±‡∑ä‡∑É‡∑ä‡∑Ü‡∑ù‡∂∏‡∂ª‡∑ä ‡∑É‡∑ô‡∑Ä‡∑ì‡∂∏."/>

    <title>‡∂¥‡∑ä‡∂ª‡∑è‡∂Æ‡∂∏‡∑í‡∂ö‡∂∫: ‡∂∑‡∑è‡∑Ç‡∑è ‡∂Ü‡∂ö‡∑ò‡∂≠‡∑í ‡∂±‡∑í‡∂ª‡∑ä‡∂∏‡∑è‡∂´‡∂∫ ‡∑É‡∂≥‡∑Ñ‡∑è ‡∂ö‡∑è‡∂ª‡∑ä‡∂∫‡∂ö‡∑ä‡∑Ç‡∂∏ ‡∂ß‡∑ä‡∂ª‡∑è‡∂±‡∑ä‡∑É‡∑ä‡∑Ü‡∑ù‡∂∏‡∂ª‡∑ä ‡∑É‡∑ô‡∑Ä‡∑ì‡∂∏</title>
    <link rel="shortcut icon" href="/icon.png"/>
    <link rel="stylesheet" href="../../pylit.css?v=1">
    <link rel="canonical" href="https://nn.labml.ai/transformers/primer_ez/index.html"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/katex.min.css" integrity="sha384-zTROYFVGOfTw7JV7KUu8udsvW2fx4lWOsCEDqhBreBwlHI4ioVRtmIvEThzJHGET" crossorigin="anonymous">

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-4V3HC8HBLH"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }

        gtag('js', new Date());

        gtag('config', 'G-4V3HC8HBLH');
    </script>
</head>
<body>
<div id='container'>
    <div id="background"></div>
    <div class='section'>
        <div class='docs'>
            <p>
                <a class="parent" href="/">home</a>
                <a class="parent" href="../index.html">transformers</a>
                <a class="parent" href="index.html">primer_ez</a>
            </p>
            <p>
                <a href="https://github.com/labmlai/annotated_deep_learning_paper_implementations" target="_blank">
                    <img alt="Github"
                         src="https://img.shields.io/github/stars/labmlai/annotated_deep_learning_paper_implementations?style=social"
                         style="max-width:100%;"/></a>
                <a href="https://twitter.com/labmlai" rel="nofollow" target="_blank">
                    <img alt="Twitter"
                         src="https://img.shields.io/twitter/follow/labmlai?style=social"
                         style="max-width:100%;"/></a>
            </p>
            <p>
                <a href="https://github.com/labmlai/annotated_deep_learning_paper_implementations/tree/master/labml_nn/transformers/primer_ez/__init__.py" target="_blank">
                    View code on Github</a>
            </p>
        </div>
    </div>
    <div class='section' id='section-0'>
        <div class='docs doc-strings'>
            <div class='section-link'>
                <a href='#section-0'>#</a>
            </div>
            <h1>‡∂¥‡∑ä‡∂ª‡∑è‡∂Æ‡∂∏‡∑í‡∂ö‡∂∫: ‡∂∑‡∑è‡∑Ç‡∑è ‡∂Ü‡∂ö‡∑ò‡∂≠‡∑í ‡∂±‡∑í‡∂ª‡∑ä‡∂∏‡∑è‡∂´‡∂∫ ‡∑É‡∂≥‡∑Ñ‡∑è ‡∂ö‡∑è‡∂ª‡∑ä‡∂∫‡∂ö‡∑ä‡∑Ç‡∂∏ ‡∂ß‡∑ä‡∂ª‡∑è‡∂±‡∑ä‡∑É‡∑ä‡∑Ü‡∑ù‡∂∏‡∂ª‡∑ä ‡∑É‡∑ô‡∑Ä‡∑ì‡∂∏</h1>
<p>‡∂∏‡∑ô‡∂∫ <a href="https://pytorch.org">PyTorch</a> ‡∂ö‡∂©‡∂Ø‡∑è‡∑É‡∑í <a href="https://papers.labml.ai/paper/2109.08668">‡∂¥‡∑ä‡∂ª‡∂∫‡∑í‡∂∏‡∂ª‡∑ä ‡∂ö‡∑ä‡∂ª‡∑í‡∂∫‡∑è‡∂≠‡∑ä‡∂∏‡∂ö ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏: ‡∂∑‡∑è‡∑Ç‡∑è ‡∂Ü‡∂ö‡∑ò‡∂≠‡∑í ‡∂±‡∑í‡∂ª‡∑ä‡∂∏‡∑è‡∂´‡∂∫ ‡∑É‡∂≥‡∑Ñ‡∑è ‡∂ö‡∑è‡∂ª‡∑ä‡∂∫‡∂ö‡∑ä‡∑Ç‡∂∏ ‡∂ß‡∑ä‡∂ª‡∑è‡∂±‡∑ä‡∑É‡∑ä‡∑Ü‡∑ù‡∂∏‡∂ª‡∑ä ‡∑É‡∑ô‡∑Ä‡∑ì‡∂∏</a> . </p>
<p>‡∂ö‡∂≠‡∑î‡∑Ä‡∂ª‡∑î‡∂±‡∑ä‡∂ß‡∑ä‡∂ª‡∑è‡∂±‡∑ä‡∑É‡∑ä‡∑Ü‡∑ù‡∂∏‡∂ª‡∑ä ‡∂ú‡∑ò‡∑Ñ ‡∂±‡∑í‡∂ª‡∑ä‡∂∏‡∑è‡∂´ ‡∑Å‡∑í‡∂Ω‡∑ä‡∂¥‡∂∫ ‡∑É‡∂≥‡∑Ñ‡∑è ‡∂¥‡∂ª‡∑í‡∂´‡∑è‡∂∏‡∑ì‡∂∫ ‡∑É‡∑ô‡∑Ä‡∑ì‡∂∏‡∂ö‡∑ä ‡∂ö‡∂ª‡∂∫‡∑í. ‡∑É‡∑ô‡∑Ä‡∑î‡∂∏‡∑ä ‡∂¥‡∑ä‡∂ª‡∂∫‡∑í‡∂∏‡∂ª‡∑ä ‡∂∑‡∑è‡∑Ä‡∑í‡∂≠‡∂∫‡∑ô‡∂±‡∑ä ‡∑É‡∑ú‡∂∫‡∑è‡∂ú‡∂≠‡∑ä ‡∂ú‡∑ò‡∑Ñ ‡∂±‡∑í‡∂ª‡∑ä‡∂∏‡∑è‡∂´ ‡∑Å‡∑í‡∂Ω‡∑ä‡∂¥‡∂∫ ‡∂î‡∑Ä‡∑î‡∂±‡∑ä ‡∂±‡∂∏‡∑ä ‡∂ö‡∂ª‡∂∫‡∑í (‡∂¥‡∑ä‡∂ª‡∂∫‡∑í‡∂∏‡∑ä‡∂ß‡∑í‡∑Ä‡∑ä‡∑É‡∑ä ‡∂ß‡∑ä‡∂ª‡∑è‡∂±‡∑ä‡∑É‡∑ä‡∑Ü‡∑ù‡∂∏‡∂ª‡∑ä ‡∑É‡∑ô‡∑Ä‡∑ñ). <strong>‡∂¥‡∑ä‡∂ª‡∂∫‡∑í‡∂∏‡∂ª‡∑äEZ</strong> ‡∂∫‡∂±‡∑î ‡∂∏‡∑î‡∂Ω‡∑ä ‡∂ß‡∑ä‡∂ª‡∑è‡∂±‡∑ä‡∑É‡∑ä‡∑Ü‡∑ù‡∂∏‡∂ª‡∂∫ ‡∑Ñ‡∑è ‡∑É‡∑É‡∂≥‡∂± ‡∑Ä‡∑í‡∂ß ‡∂¥‡∑ä‡∂ª‡∂∫‡∑í‡∂∏‡∂ª‡∑ä ‡∑Ñ‡∑í ‡∑Ä‡∂©‡∑è‡∂≠‡∑ä‡∂∏ ‡∑Å‡∂ö‡∑ä‡∂≠‡∑í‡∂∏‡∂≠‡∑ä ‡∑Ä‡∑ô‡∂±‡∑É‡∑ä ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏‡∑ä ‡∂Ø‡∑ô‡∂ö ‡∑É‡∑Ñ‡∑í‡∂≠ ‡∂ú‡∑ò‡∑Ñ ‡∂±‡∑í‡∂ª‡∑ä‡∂∏‡∑è‡∂´ ‡∑Å‡∑í‡∂Ω‡∑ä‡∂¥‡∂∫‡∂∫‡∑í. ‡∂¥‡∑ä‡∂ª‡∂∫‡∑í‡∂∏‡∂ª‡∑ä EZ ‡∑Ä‡∑ê‡∂±‡∑í‡∂Ω‡∑è ‡∂ß‡∑ä‡∂ª‡∑è‡∂±‡∑ä‡∑É‡∑ä‡∑Ü‡∑ù‡∂∏‡∂ª‡∂∫ ‡∑Ä‡∂©‡∑è ‡∑Ä‡∑ö‡∂ú‡∂∫‡∑ô‡∂±‡∑ä ‡∂Ø‡∑î‡∂∏‡∑ä‡∂ª‡∑í‡∂∫. </p>
<h3>‡∑Ä‡∂ª‡∑ä‡∂úRelu</h3>
<p>‡∑É‡∑ô‡∑Ä‡∑î‡∂∏‡∂∏‡∂ú‡∑í‡∂±‡∑ä ‡∑É‡∑ú‡∂∫‡∑è‡∂ú‡∂≠‡∑ä ‡∑Ä‡∂©‡∑è‡∂≠‡∑ä‡∂∏ effective ‡∂Ω‡∂Ø‡∑è‡∂∫‡∑ì ‡∑Ä‡∑ô‡∂±‡∑É‡∑ä ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏ ‡∑Ä‡∂±‡∑ä‡∂±‡∑ö <a href="../feed_forward.html">‡∑É‡∑ä‡∂Æ‡∑è‡∂±-‡∂±‡∑ê‡∂´‡∑Ä‡∂≠‡∑ä ‡∂¥‡∑ù‡∑Ç‡∂ö ‡∂∏‡∑ú‡∂©‡∑í‡∂∫‡∑î‡∂Ω‡∂∫‡∑ö</a>RelU ‡∑Ä‡∑ô‡∂±‡∑î‡∑Ä‡∂ß ‡∂†‡∂≠‡∑î‡∂ª‡∑É‡∑ä‡∂ª‡∑è‡∂ö‡∑è‡∂ª RelU ‡∂∑‡∑è‡∑Ä‡∑í‡∂≠‡∑è ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏‡∂∫‡∑í. </p>
<p><span ><span class="katex-display"><span class="katex"><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.204008em;vertical-align:-0.25em;"></span><span class="mord coloredeq eqa" style=""><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel" style="">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord" style=""><span class="mord" style=""><span class="mop" style=""><span style="">m</span><span style="">a</span><span style="">x</span></span><span class="mopen" style="">(</span><span class="mord mathnormal" style="">x</span><span class="mpunct" style="">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord" style="">0</span><span class="mclose" style="">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.954008em;"><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style=""><span class="mord mtight" style="">2</span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<h3>‡∂∂‡∑Ñ‡∑î-Dconv-‡∑Ñ‡∑í‡∑É‡∂Ö‡∑Ä‡∂∞‡∑è‡∂±‡∂∫ (MDHA)</h3>
<p>‡∂ä‡∑Ö‡∂üeffective ‡∂Ω‡∂Ø‡∑è‡∂∫‡∑ì ‡∑Ä‡∑ô‡∂±‡∑É‡∑ä ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏ ‡∂∫‡∂±‡∑î ‡∑Ä‡∑í‡∂∏‡∑É‡∑î‡∂∏‡∑ä, ‡∂∫‡∂≠‡∑î‡∂ª‡∑î ‡∑É‡∑Ñ ‡∂Ö‡∂ú‡∂∫‡∂±‡∑ä ‡∑É‡∂≥‡∑Ñ‡∑è ‡∂∂‡∑Ñ‡∑î-‡∑Ñ‡∑í‡∑É ‡∂¥‡∑ä‡∂ª‡∂ö‡∑ä‡∑Ç‡∑ö‡∂¥‡∂´‡∂∫ ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏‡∑ô‡∂±‡∑ä ‡∂¥‡∑É‡∑î ‡∂ú‡∑ê‡∂π‡∑î‡∂ª‡∂ß ‡∂Ö‡∂±‡∑î‡∑Ä <span ><span class="katex"><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">√ó</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></span> ‡∂ö‡∑ê‡∂ß‡∑í ‡∂ú‡∑ê‡∑É‡∑î‡∂∏‡∂ö‡∑í. ‡∂∏‡∑ô‡∂∏ convolution ‡∂Ö‡∂±‡∑î‡∂ö‡∑ä‡∂ª‡∂∏‡∂∫ ‡∂∏‡∑è‡∂±‡∂∫‡∂ö‡∑ä ‡∂î‡∑É‡∑ä‡∑É‡∑ö ‡∑É‡∑Ñ ‡∂±‡∑è‡∂Ω‡∑í‡∂ö‡∑è‡∑Ä (‡∂ú‡∑ê‡∂π‡∑î‡∂ª-‡∂Ö‡∂±‡∑î‡∑Ä) ‡∑Ä‡∑ö. ‡∂¥‡∑ê‡∑Ñ‡∑ê‡∂Ø‡∑í‡∂Ω‡∑í ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏ ‡∑É‡∂≥‡∑Ñ‡∑è, ‡∂ë‡∂ö‡∑ä ‡∂ë‡∂ö‡∑ä ‡∑Ñ‡∑í‡∑É‡∑ô‡∑Ñ‡∑í ‡∂±‡∑è‡∂Ω‡∑í‡∂ö‡∑è ‡∂ú‡∂´‡∂± ‡∑É‡∂Ç‡∂ö‡∑ù‡∂†‡∂±‡∂∫ ‡∂±‡∂∏‡∑ä ‡∂ë‡∂ö‡∑ä ‡∂ë‡∂ö‡∑ä <span ><span class="katex"><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord coloredeq eqd" style=""><span class="mord" style=""><span class="mord mathnormal" style="">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style=""><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></span> ‡∂±‡∑è‡∂Ω‡∑í‡∂ö‡∑è ‡∑É‡∂≥‡∑Ñ‡∑è <span ><span class="katex"><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">√ó</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span></span></span></span></span> ‡∂ö‡∂ª‡∑ä‡∂±‡∂Ω‡∑ä ‡∂á‡∂≠. <span ><span class="katex"><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord coloredeq eqd" style=""><span class="mord" style=""><span class="mord mathnormal" style="">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style=""><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></span> </p>
<p>‡∂¥‡∑ä‡∂ª‡∂∫‡∑í‡∂∏‡∂ª‡∑äEZ ‡∑É‡∂≥‡∑Ñ‡∑è<a href="experiment.html">‡∂Ö‡∂≠‡∑ä‡∑Ñ‡∂Ø‡∑è ‡∂∂‡∑ê‡∂Ω‡∑ì‡∂∏‡∑ö ‡∂ö‡∑ö‡∂≠‡∂∫ ‡∂∏‡∑ô‡∂±‡∑ä‡∂±</a>. </p>
<p><a href="https://app.labml.ai/run/30adb7aa1ab211eca7310f80a114e8a4"><img alt="View Run" src="https://img.shields.io/badge/labml-experiment-brightgreen"></a></p>

        </div>
        <div class='code'>
            <div class="highlight"><pre><span class="lineno">40</span><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="lineno">41</span><span class="kn">from</span> <span class="nn">torch</span> <span class="kn">import</span> <span class="n">nn</span>
<span class="lineno">42</span>
<span class="lineno">43</span><span class="kn">from</span> <span class="nn">labml_helpers.module</span> <span class="kn">import</span> <span class="n">Module</span>
<span class="lineno">44</span><span class="kn">from</span> <span class="nn">labml_nn.transformers</span> <span class="kn">import</span> <span class="n">MultiHeadAttention</span></pre></div>
        </div>
    </div>
    <div class='section' id='section-1'>
        <div class='docs doc-strings'>
            <div class='section-link'>
                <a href='#section-1'>#</a>
            </div>
            <h2>‡∑Ä‡∂ª‡∑ä‡∂úRelu ‡∑É‡∂ö‡∑ä‡∂ª‡∑í‡∂∫</h2>
<p><span ><span class="katex-display"><span class="katex"><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.204008em;vertical-align:-0.25em;"></span><span class="mord coloredeq eqa" style=""><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel" style="">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord" style=""><span class="mord" style=""><span class="mop" style=""><span style="">m</span><span style="">a</span><span style="">x</span></span><span class="mopen" style="">(</span><span class="mord mathnormal" style="">x</span><span class="mpunct" style="">,</span><span class="mspace" style="margin-right:0.16666666666666666em"></span><span class="mord" style="">0</span><span class="mclose" style="">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.954008em;"><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight" style=""><span class="mord mtight" style="">2</span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>SquaredRelU <a href="../feed_forward.html">‡∂≠‡∂≠‡∑ä‡∂≠‡∑ä‡∑Ä‡∂∫ ‡∂±‡∑ê‡∂´‡∑Ä‡∂≠‡∑ä feedforward ‡∂∏‡∑ú‡∂©‡∑í‡∂∫‡∑î‡∂Ω‡∂∫</a>‡∂≠‡∑î‡∑Ö ‡∑É‡∂ö‡∑ä‡∂ª‡∑í‡∂∫ ‡∂ö‡∑è‡∂ª‡∑ä‡∂∫‡∂∫ ‡∂Ω‡∑ô‡∑É ‡∂∑‡∑è‡∑Ä‡∑í‡∂≠‡∑è ‡∂ö‡∂ª‡∂∫‡∑í. </p>

        </div>
        <div class='code'>
            <div class="highlight"><pre><span class="lineno">47</span><span class="k">class</span> <span class="nc">SquaredReLU</span><span class="p">(</span><span class="n">Module</span><span class="p">):</span></pre></div>
        </div>
    </div>
    <div class='section' id='section-2'>
        <div class='docs'>
            <div class='section-link'>
                <a href='#section-2'>#</a>
            </div>
            
        </div>
        <div class='code'>
            <div class="highlight"><pre><span class="lineno">57</span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="lineno">58</span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="lineno">59</span>        <span class="bp">self</span><span class="o">.</span><span class="n">relu</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">()</span></pre></div>
        </div>
    </div>
    <div class='section' id='section-3'>
        <div class='docs'>
            <div class='section-link'>
                <a href='#section-3'>#</a>
            </div>
            
        </div>
        <div class='code'>
            <div class="highlight"><pre><span class="lineno">61</span>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span></pre></div>
        </div>
    </div>
    <div class='section' id='section-4'>
        <div class='docs'>
            <div class='section-link'>
                <a href='#section-4'>#</a>
            </div>
            <p>Relu‡∂Ö‡∂∫‡∂Ø‡∑î‡∂∏‡∑ä ‡∂ö‡∂ª‡∂±‡∑ä‡∂± </p>

        </div>
        <div class='code'>
            <div class="highlight"><pre><span class="lineno">63</span>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></pre></div>
        </div>
    </div>
    <div class='section' id='section-5'>
        <div class='docs'>
            <div class='section-link'>
                <a href='#section-5'>#</a>
            </div>
            <p>‡∂ë‡∂∫‡∑Ä‡∂ª‡∑ä‡∂ú ‡∂ö‡∂ª‡∂±‡∑ä‡∂± </p>

        </div>
        <div class='code'>
            <div class="highlight"><pre><span class="lineno">65</span>        <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span></pre></div>
        </div>
    </div>
    <div class='section' id='section-6'>
        <div class='docs doc-strings'>
            <div class='section-link'>
                <a href='#section-6'>#</a>
            </div>
            <h2>‡∂Ö‡∑Ä‡∂ö‡∑è‡∑Å‡∑ì‡∂∫‡∂ú‡∑ê‡∂π‡∑î‡∂ª ‡∂±‡∑ê‡∂´‡∑Ä‡∂≠‡∑ä ‡∑É‡∂∏‡∑ä‡∂∏‡∑î‡∂≠‡∑í‡∂∫</h2>

        </div>
        <div class='code'>
            <div class="highlight"><pre><span class="lineno">68</span><span class="k">class</span> <span class="nc">SpatialDepthWiseConvolution</span><span class="p">(</span><span class="n">Module</span><span class="p">):</span></pre></div>
        </div>
    </div>
    <div class='section' id='section-7'>
        <div class='docs doc-strings'>
            <div class='section-link'>
                <a href='#section-7'>#</a>
            </div>
            <ul><li><code  class="highlight"><span></span><span class="n">d_k</span></code>
 ‡∂ë‡∂ö‡∑ä ‡∂ë‡∂ö‡∑ä ‡∑Ñ‡∑í‡∑É‡∑ô‡∑Ñ‡∑í ‡∂±‡∑è‡∂Ω‡∑í‡∂ö‡∑è ‡∂ú‡∂´‡∂± ‡∑Ä‡∑ö</li></ul>

        </div>
        <div class='code'>
            <div class="highlight"><pre><span class="lineno">73</span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">d_k</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">kernel_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">):</span></pre></div>
        </div>
    </div>
    <div class='section' id='section-8'>
        <div class='docs'>
            <div class='section-link'>
                <a href='#section-8'>#</a>
            </div>
            
        </div>
        <div class='code'>
            <div class="highlight"><pre><span class="lineno">77</span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="lineno">78</span>        <span class="bp">self</span><span class="o">.</span><span class="n">kernel_size</span> <span class="o">=</span> <span class="n">kernel_size</span></pre></div>
        </div>
    </div>
    <div class='section' id='section-9'>
        <div class='docs'>
            <div class='section-link'>
                <a href='#section-9'>#</a>
            </div>
            <p>‡∂Ö‡∂¥‡∑í‡∂¥‡∂∫‡∑í‡∂ß‡∑ù‡∂ª‡∑ä‡∂†‡∑ä <code  class="highlight"><span></span><span class="n">Conv1d</span></code>
 ‡∂∏‡∑ú‡∂©‡∑í‡∂∫‡∑î‡∂Ω‡∂∫ ‡∂∑‡∑è‡∑Ä‡∑í‡∂≠‡∑è ‡∂ö‡∂ª‡∂∏‡∑î. ‡∂ë‡∂ö‡∑ä ‡∂ë‡∂ö‡∑ä ‡∂±‡∑è‡∂Ω‡∑í‡∂ö‡∑è‡∑Ä ‡∑É‡∂≥‡∑Ñ‡∑è ‡∑Ä‡∑ô‡∂±‡∂∏ ‡∑É‡∂Ç‡∑Ä‡∑Ñ‡∂±‡∂∫‡∂ö‡∑ä (‡∑Ä‡∑í‡∑Ä‡∑í‡∂∞ ‡∂ö‡∂ª‡∑ä‡∂±‡∂Ω‡∑ä ‡∑É‡∂∏‡∂ü) ‡∑É‡∑í‡∂Ø‡∑î ‡∑Ä‡∂± ‡∂¥‡∂ª‡∑í‡∂Ø‡∑í ‡∂±‡∑è‡∂Ω‡∑í‡∂ö‡∑è ‡∂ú‡∂´‡∂±‡∂ß ‡∑É‡∂∏‡∑è‡∂± ‡∑Ä‡∂± ‡∂¥‡∂ª‡∑í‡∂Ø‡∑í ‡∂ö‡∂´‡∑ä‡∂©‡∑è‡∂∫‡∂∏‡∑ä ‡∂ú‡∂´‡∂± ‡∂Ö‡∂¥‡∑í ‡∑É‡∂ö‡∑É‡∑ä ‡∂ö‡∂ª‡∂∏‡∑î. ‡∂Ö‡∂¥‡∑í ‡∂Ø‡∑ô‡∂¥‡∑ê‡∂≠‡∑ä‡∂≠‡∂ß‡∂∏ ‡∂¥‡∑î‡∂ª‡∑Ä‡∂± ‡∂ë‡∂ö‡∂≠‡∑î ‡∂ö‡∂ª ‡∂¥‡∑É‡∑î‡∑Ä ‡∂±‡∑í‡∑Ä‡∑ê‡∂ª‡∂Ø‡∑í ‡∑Ä‡∂©‡∑è‡∂≠‡∑ä‡∂∏ <code  class="highlight"><span></span><span class="n">kernel_size</span> <span class="o">-</span> <span class="mi">1</span></code>
 ‡∂¥‡∑ä‡∂ª‡∂≠‡∑í </p>. ‡∂Ω ‡∂Ω‡∂∂‡∑è ‡∂ú‡∂±‡∑í‡∂∏‡∑î

        </div>
        <div class='code'>
            <div class="highlight"><pre><span class="lineno">83</span>        <span class="bp">self</span><span class="o">.</span><span class="n">conv</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv1d</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="n">d_k</span><span class="p">,</span> <span class="n">out_channels</span><span class="o">=</span><span class="n">d_k</span><span class="p">,</span>
<span class="lineno">84</span>                              <span class="n">kernel_size</span><span class="o">=</span><span class="p">(</span><span class="n">kernel_size</span><span class="p">,),</span> <span class="n">padding</span><span class="o">=</span><span class="p">(</span><span class="n">kernel_size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,),</span> <span class="n">groups</span><span class="o">=</span><span class="n">d_k</span><span class="p">)</span></pre></div>
        </div>
    </div>
    <div class='section' id='section-10'>
        <div class='docs doc-strings'>
            <div class='section-link'>
                <a href='#section-10'>#</a>
            </div>
            <p> <code  class="highlight"><span></span><span class="n">x</span></code>
 ‡∑Ñ‡∑ê‡∂©‡∂∫ ‡∂á‡∂≠ <code  class="highlight"><span></span><span class="p">[</span><span class="n">seq_len</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">,</span> <span class="n">heads</span><span class="p">,</span> <span class="n">d_k</span><span class="p">]</span></code>
</p>

        </div>
        <div class='code'>
            <div class="highlight"><pre><span class="lineno">86</span>    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span></pre></div>
        </div>
    </div>
    <div class='section' id='section-11'>
        <div class='docs'>
            <div class='section-link'>
                <a href='#section-11'>#</a>
            </div>
            <p>‡∑Ñ‡∑ê‡∂©‡∂∫‡∂Ω‡∂∂‡∑è ‡∂ú‡∂±‡∑ä‡∂± </p>

        </div>
        <div class='code'>
            <div class="highlight"><pre><span class="lineno">92</span>        <span class="n">seq_len</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">,</span> <span class="n">heads</span><span class="p">,</span> <span class="n">d_k</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span></pre></div>
        </div>
    </div>
    <div class='section' id='section-12'>
        <div class='docs'>
            <div class='section-link'>
                <a href='#section-12'>#</a>
            </div>
            <p>‡∂ö‡∑í‡∂ª‡∑ì‡∂∏‡∂ß‡∂Ö‡∑Ä‡∑É‡∂ª <code  class="highlight"><span></span><span class="p">[</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">heads</span><span class="p">,</span> <span class="n">d_k</span><span class="p">,</span> <span class="n">seq_len</span><span class="p">]</span></code>
 </p>

        </div>
        <div class='code'>
            <div class="highlight"><pre><span class="lineno">94</span>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span></pre></div>
        </div>
    </div>
    <div class='section' id='section-13'>
        <div class='docs'>
            <div class='section-link'>
                <a href='#section-13'>#</a>
            </div>
            <p>‡∑Ñ‡∑ê‡∂©‡∂∫‡∑Ä‡∑ô‡∂±‡∑É‡∑ä ‡∂ö‡∂ª‡∂±‡∑ä‡∂± <code  class="highlight"><span></span><span class="p">[</span><span class="n">batch_size</span> <span class="o">*</span> <span class="n">heads</span><span class="p">,</span> <span class="n">d_k</span><span class="p">,</span> <span class="n">seq_len</span><span class="p">]</span></code>
 </p>

        </div>
        <div class='code'>
            <div class="highlight"><pre><span class="lineno">96</span>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">batch_size</span> <span class="o">*</span> <span class="n">heads</span><span class="p">,</span> <span class="n">d_k</span><span class="p">,</span> <span class="n">seq_len</span><span class="p">)</span></pre></div>
        </div>
    </div>
    <div class='section' id='section-14'>
        <div class='docs'>
            <div class='section-link'>
                <a href='#section-14'>#</a>
            </div>
            <p>1D‡∂ö‡∑ê‡∂ß‡∑í ‡∂ú‡∑ê‡∑É‡∑î‡∂∏‡∑ö ‡∂Ü‡∂ö‡∑ò‡∂≠‡∑í‡∂∫‡∑ö ‡∂Ü‡∂Ø‡∑è‡∂±‡∂∫ ‡∂¥‡∑í‡∑Ö‡∑í‡∂ú‡∂±‡∑ì <code  class="highlight"><span></span><span class="p">[</span><span class="n">N</span><span class="p">,</span> <span class="n">channels</span><span class="p">,</span> <span class="n">sequence</span><span class="p">]</span></code>
 </p>

        </div>
        <div class='code'>
            <div class="highlight"><pre><span class="lineno">99</span>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conv</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></pre></div>
        </div>
    </div>
    <div class='section' id='section-15'>
        <div class='docs'>
            <div class='section-link'>
                <a href='#section-15'>#</a>
            </div>
            <p>‡∂Ö‡∂¥‡∑í‡∂Ø‡∑ô‡∂¥‡∑ê‡∂≠‡∑ä‡∂≠‡∑ô‡∂±‡∑ä‡∂∏ ‡∂Ü‡∑Ä‡∂ª‡∂´‡∂∫‡∂ö‡∑í‡∂±‡∑ä ‡∑É‡∂∏‡∂±‡∑ä‡∑Ä‡∑í‡∂≠ ‡∂∂‡∑ê‡∑Ä‡∑í‡∂±‡∑ä ‡∂±‡∑í‡∑Ä‡∑ê‡∂ª‡∂Ø‡∑í ‡∑Ä‡∂©‡∑è‡∂≠‡∑ä‡∂∏ <code  class="highlight"><span></span><span class="n">kernel_size</span> <span class="o">-</span> <span class="mi">1</span></code>
 ‡∂¥‡∑ä‡∂ª‡∂≠‡∑í results ‡∂Ω ‡∂∂‡∑ù‡∂ú ‡∂ö‡∂ª‡∂±‡∑ä‡∂± </p>

        </div>
        <div class='code'>
            <div class="highlight"><pre><span class="lineno">101</span>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">:</span><span class="o">-</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel_size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span></pre></div>
        </div>
    </div>
    <div class='section' id='section-16'>
        <div class='docs'>
            <div class='section-link'>
                <a href='#section-16'>#</a>
            </div>
            <p>‡∂±‡∑ê‡∑Ä‡∂≠‡∑Ñ‡∑ê‡∂©‡∂ú‡∑É‡∑ä‡∑Ä‡∂±‡∑ä‡∂± <code  class="highlight"><span></span><span class="p">[</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">heads</span><span class="p">,</span> <span class="n">d_k</span><span class="p">,</span> <span class="n">seq_len</span><span class="p">]</span></code>
 </p>

        </div>
        <div class='code'>
            <div class="highlight"><pre><span class="lineno">103</span>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">heads</span><span class="p">,</span> <span class="n">d_k</span><span class="p">,</span> <span class="n">seq_len</span><span class="p">)</span></pre></div>
        </div>
    </div>
    <div class='section' id='section-17'>
        <div class='docs'>
            <div class='section-link'>
                <a href='#section-17'>#</a>
            </div>
            <p>‡∂ö‡∑í‡∂ª‡∑ì‡∂∏‡∂ß‡∂Ö‡∑Ä‡∑É‡∂ª <code  class="highlight"><span></span><span class="p">[</span><span class="n">seq_len</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">,</span> <span class="n">heads</span><span class="p">,</span> <span class="n">d_k</span><span class="p">]</span></code>
 </p>

        </div>
        <div class='code'>
            <div class="highlight"><pre><span class="lineno">105</span>        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span></pre></div>
        </div>
    </div>
    <div class='section' id='section-18'>
        <div class='docs'>
            <div class='section-link'>
                <a href='#section-18'>#</a>
            </div>
            <p> </p>

        </div>
        <div class='code'>
            <div class="highlight"><pre><span class="lineno">108</span>        <span class="k">return</span> <span class="n">x</span></pre></div>
        </div>
    </div>
    <div class='section' id='section-19'>
        <div class='docs doc-strings'>
            <div class='section-link'>
                <a href='#section-19'>#</a>
            </div>
            <h2>‡∂∂‡∑Ñ‡∑î-Dconv-‡∑Ñ‡∑í‡∑É‡∂Ö‡∑Ä‡∂∞‡∑è‡∂±‡∂∫ (MDHA)</h2>
<p>‡∂Ö‡∂¥‡∑í <a href="../mha.html#MHA">‡∂∂‡∑Ñ‡∑î-‡∂¥‡∑ä‡∂ª‡∂∞‡∑è‡∂± ‡∂Ö‡∑Ä‡∂∞‡∑è‡∂±‡∂∫</a> ‡∂Ö‡∂¥‡∂ú‡∑ö ‡∂∏‡∑î‡∂Ω‡∑ä ‡∂ö‡∑ä‡∂ª‡∑í‡∂∫‡∑è‡∂≠‡∑ä‡∂∏‡∂ö ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏ ‡∂Ø‡∑ì‡∂ª‡∑ä and ‡∂ö‡∂ª‡∂± ‡∂Ö‡∂≠‡∂ª ‡∑Ä‡∑í‡∂∏‡∑É‡∑î‡∂∏, ‡∂∫‡∂≠‡∑î‡∂ª ‡∑É‡∑Ñ ‡∑Ä‡∂ß‡∑í‡∂±‡∑è‡∂ö‡∂∏‡∑ä ‡∂¥‡∑ä‡∂ª‡∂ö‡∑ä‡∑Ç‡∑ö‡∂¥‡∂´ ‡∑É‡∂≥‡∑Ñ‡∑è ‡∂Ö‡∑Ä‡∂ö‡∑è‡∑Å‡∑ì‡∂∫ ‡∂ú‡∑ê‡∂π‡∑î‡∂ª-‡∂±‡∑ê‡∂´‡∑Ä‡∂≠‡∑ä ‡∑É‡∂∏‡∑ä‡∂∏‡∑î‡∂≠‡∑í‡∂∫ ‡∂ë‡∂ö‡∑ä ‡∂ö‡∂ª‡∂∏‡∑î. </p>

        </div>
        <div class='code'>
            <div class="highlight"><pre><span class="lineno">111</span><span class="k">class</span> <span class="nc">MultiDConvHeadAttention</span><span class="p">(</span><span class="n">MultiHeadAttention</span><span class="p">):</span></pre></div>
        </div>
    </div>
    <div class='section' id='section-20'>
        <div class='docs'>
            <div class='section-link'>
                <a href='#section-20'>#</a>
            </div>
            
        </div>
        <div class='code'>
            <div class="highlight"><pre><span class="lineno">119</span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">heads</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">d_model</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">dropout_prob</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">):</span>
<span class="lineno">120</span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">heads</span><span class="p">,</span> <span class="n">d_model</span><span class="p">,</span> <span class="n">dropout_prob</span><span class="p">)</span></pre></div>
        </div>
    </div>
    <div class='section' id='section-21'>
        <div class='docs'>
            <div class='section-link'>
                <a href='#section-21'>#</a>
            </div>
            <p><a href="../mha.html#MHA">‡∂∂‡∑Ñ‡∑î-‡∂¥‡∑ä‡∂ª‡∂∞‡∑è‡∂± ‡∂Ö‡∑Ä‡∂∞‡∑è‡∂±‡∂∫</a> ‡∑Ä‡∑í‡∂∏‡∑É‡∑î‡∂∏ ‡∂±‡∑í‡∂ª‡∑ä‡∂∏‡∑è‡∂´‡∂∫ ‡∂ö‡∂ª‡∂±‡∑î ‡∂á‡∂≠, ‡∂¥‡∑ä‡∂ª‡∂∞‡∑è‡∂± ‡∑É‡∑Ñ ‡∂Ö‡∂ú‡∂∫ ‡∂¥‡∑ä‡∂ª‡∂ö‡∑ä‡∑Ç‡∑ö‡∂¥‡∂±‡∂∫ ‡∂∏‡∑ú‡∂©‡∑í‡∂∫‡∑î‡∂Ω <code  class="highlight"><span></span><span class="bp">self</span><span class="o">.</span><span class="n">query</span></code>
<code  class="highlight"><span></span><span class="bp">self</span><span class="o">.</span><span class="n">key</span></code>
, ‡∑É‡∑Ñ <code  class="highlight"><span></span><span class="bp">self</span><span class="o">.</span><span class="n">value</span></code>
. </p>
<p>‡∂Ö‡∂¥‡∑í‡∂î‡∑Ä‡∑î‡∂±‡∑ä ‡∂ë‡∂ö‡∑ä ‡∂ë‡∂ö‡∑ä ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏‡∂ß ‡∂Ö‡∑Ä‡∂ö‡∑è‡∑Å‡∑ì‡∂∫ ‡∂ú‡∑ê‡∂π‡∑î‡∂ª-‡∂±‡∑ê‡∂´‡∑Ä‡∂≠‡∑ä convolution ‡∑É‡∑ä‡∂Æ‡∂ª‡∂∫ ‡∂í‡∂ö‡∑è‡∂∂‡∂Ø‡∑ä‡∂∞ ‡∑Ñ‡∑è ‡∑Ä‡∑ô‡∂±‡∑î‡∑Ä‡∂ß <code  class="highlight"><span></span><span class="bp">self</span><span class="o">.</span><span class="n">query</span></code>
<code  class="highlight"><span></span><span class="bp">self</span><span class="o">.</span><span class="n">key</span></code>
, ‡∑É‡∑Ñ <code  class="highlight"><span></span><span class="bp">self</span><span class="o">.</span><span class="n">value</span></code>
. </p>
<p>üìù <em>‡∂∏‡∑ô‡∂∫ ‡∑É‡∑Ñ ‡∑Ä‡∑ê‡∂±‡∑í‡∂Ω‡∑è ‡∂ß‡∑ä‡∂ª‡∑è‡∂±‡∑ä‡∑É‡∑ä‡∑Ü‡∑ù‡∂∏‡∂ª‡∑ä ‡∂∂‡∑Ñ‡∑î-‡∑Ñ‡∑í‡∑É ‡∂Ö‡∑Ä‡∂∞‡∑è‡∂±‡∂∫ ‡∂Ö‡∂≠‡∂ª ‡∑Ä‡∑ô‡∂±‡∑É ‡∂¥‡∑ê‡∑Ñ‡∑ê‡∂Ø‡∑í‡∂Ω‡∑í‡∑Ä ‡∂¥‡∑ô‡∂±‡∑ä‡∑Ä‡∂± ‡∂∂‡∑ê‡∑Ä‡∑í‡∂±‡∑ä ‡∂∏‡∑ô‡∂∏ ‡∂¥‡∑í‡∂ª‡∑í‡∑É‡∑í‡∂Ø‡∑î ‡∂ö‡∑ä‡∂ª‡∑í‡∂∫‡∑è‡∂≠‡∑ä‡∂∏‡∂ö ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏ ‡∂≠‡∑ö‡∂ª‡∑î‡∂∏‡∑ä ‡∂ú‡∑ê‡∂±‡∑ì‡∂∏ ‡∂¥‡∑Ñ‡∑É‡∑î ‡∂∫‡∑ê‡∂∫‡∑í ‡∂Ö‡∂¥‡∂ß ‡∑Ñ‡∑ê‡∂ü‡∑ö</em>. </p>

        </div>
        <div class='code'>
            <div class="highlight"><pre><span class="lineno">130</span>        <span class="bp">self</span><span class="o">.</span><span class="n">query</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">,</span> <span class="n">SpatialDepthWiseConvolution</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">d_k</span><span class="p">))</span>
<span class="lineno">131</span>        <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="n">SpatialDepthWiseConvolution</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">d_k</span><span class="p">))</span>
<span class="lineno">132</span>        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">SpatialDepthWiseConvolution</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">d_k</span><span class="p">))</span></pre></div>
        </div>
    </div>
    <div class='footer'>
        <a href="https://papers.labml.ai">Trending Research Papers</a>
        <a href="https://labml.ai">labml.ai</a>
    </div>
</div>
<script src=../../interactive.js?v=1"></script>
<script>
    function handleImages() {
        var images = document.querySelectorAll('p>img')

        for (var i = 0; i < images.length; ++i) {
            handleImage(images[i])
        }
    }

    function handleImage(img) {
        img.parentElement.style.textAlign = 'center'

        var modal = document.createElement('div')
        modal.id = 'modal'

        var modalContent = document.createElement('div')
        modal.appendChild(modalContent)

        var modalImage = document.createElement('img')
        modalContent.appendChild(modalImage)

        var span = document.createElement('span')
        span.classList.add('close')
        span.textContent = 'x'
        modal.appendChild(span)

        img.onclick = function () {
            console.log('clicked')
            document.body.appendChild(modal)
            modalImage.src = img.src
        }

        span.onclick = function () {
            document.body.removeChild(modal)
        }
    }

    handleImages()
</script>
</body>
</html>